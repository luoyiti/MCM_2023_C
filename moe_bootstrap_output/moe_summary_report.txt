
================================================================================
MoE (Mixture of Experts) + Bootstrap 分布预测综合报告
================================================================================

一、模型配置
─────────────────────────────────────────────────
专家数量 (num_experts): 2
每个专家的隐藏层大小 (hidden_size): 128
Top-K 路由 (k): 2
辅助损失系数 (aux_coef): 0.005
专家分化正则项 (diversity_coef): 0.001
学习率 (lr): 0.005
权重衰减 (weight_decay): 0.0001
早停耐心 (patience): 50
样本权重模式: sqrt

二、训练结果
─────────────────────────────────────────────────
最佳验证轮次: 44
最佳验证损失: 1.584378
总训练轮次: 94

三、单模型测试集评估指标
─────────────────────────────────────────────────
MAE (平均绝对误差): 0.032317
  → 7个桶的概率平均误差约 3.23%

RMSE (均方根误差): 0.059322

KL散度: 0.393530
  → 预测分布与真实分布的信息差异 (越小越好)

JS散度: 0.107979
  → 对称的分布差异度量 (0~1, 越小越好)

TV距离: 0.113109
  → 总变差距离 (越小越好)

余弦相似度: 0.970150
  → 分布向量的相似程度 (越接近1越好)

R²: -0.100862
  → 模型解释方差的比例 (越接近1越好)

最大误差: 0.742573
  → 单个桶上的最大预测偏差

四、Bootstrap 不确定性估计结果
─────────────────────────────────────────────────
Bootstrap 次数: 100
置信区间水平: 95%

Bootstrap均值预测的MAE: 0.030470
Bootstrap均值预测的RMSE: 0.053859
Bootstrap均值预测的R²: 0.049851

置信度统计:
  - 平均置信度得分: 61.9946
  - 置信度标准差: 14.0852
  - 最低置信度: 9.7363
  - 最高置信度: 96.0817

五、专家使用率分析
─────────────────────────────────────────────────
专家 0: 使用率=100.0%, 平均门控权重=0.4778
专家 1: 使用率=100.0%, 平均门控权重=0.5222

六、输出文件
─────────────────────────────────────────────────
预测结果: /Users/luoyiti/Project/MCM_2023_C/task2_distribution_prediction/models/../../moe_bootstrap_output/moe_softmax_pred_output.csv
训练曲线: /Users/luoyiti/Project/MCM_2023_C/task2_distribution_prediction/models/../../moe_bootstrap_output/moe_training_history.png
分布对比: /Users/luoyiti/Project/MCM_2023_C/task2_distribution_prediction/models/../../moe_bootstrap_output/moe_distribution_comparison.png
误差分析: /Users/luoyiti/Project/MCM_2023_C/task2_distribution_prediction/models/../../moe_bootstrap_output/moe_error_analysis.png
性能指标: /Users/luoyiti/Project/MCM_2023_C/task2_distribution_prediction/models/../../moe_bootstrap_output/moe_performance_metrics.png
专家使用率: /Users/luoyiti/Project/MCM_2023_C/task2_distribution_prediction/models/../../moe_bootstrap_output/moe_expert_usage.png
辅助损失曲线: /Users/luoyiti/Project/MCM_2023_C/task2_distribution_prediction/models/../../moe_bootstrap_output/moe_aux_loss.png
门控热力图: /Users/luoyiti/Project/MCM_2023_C/task2_distribution_prediction/models/../../moe_bootstrap_output/moe_expert_gate_heatmap.png
专家MAE热力图: /Users/luoyiti/Project/MCM_2023_C/task2_distribution_prediction/models/../../moe_bootstrap_output/moe_expert_mae_heatmap.png
综合汇总图: /Users/luoyiti/Project/MCM_2023_C/task2_distribution_prediction/models/../../moe_bootstrap_output/moe_comprehensive_summary.png
Bootstrap汇总: /Users/luoyiti/Project/MCM_2023_C/task2_distribution_prediction/models/../../moe_bootstrap_output/moe_bootstrap_pred_summary.csv
JSON报告: /Users/luoyiti/Project/MCM_2023_C/task2_distribution_prediction/models/../../moe_bootstrap_output/moe_bootstrap_report.json

================================================================================
报告生成时间: 2025-12-18 23:15:55
================================================================================
